load("//:component_flags.bzl", "BUILD_VARIANTS", "variant_prefix")

[
    genrule(
        name = variant_prefix(v) + tool + "_version",
        outs = [(v.replace("-", "_") + "_" if v else "") + tool + "_version.txt"],
        cmd = "$(execpath //:{}{}) -version > $@".format(
            variant_prefix(v),
            tool,
        ),
        tools = ["//:{}{}".format(
            variant_prefix(v),
            tool,
        )],
    )
    for v in BUILD_VARIANTS
    for tool in [
        "ffmpeg",
        "ffprobe",
    ]
]
